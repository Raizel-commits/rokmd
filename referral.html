<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ROK XD â€¢ Parrainage</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{
  --bg-1:#020617;
  --bg-2:#0f172a;
  --neon:#38bdf8;
  --glass-border:rgba(56,189,248,0.22);
  --muted:rgba(255,255,255,0.45);
  --card-w:380px;
  --btn-bg:#38bdf8;
}
*{box-sizing:border-box;}
html,body{
  height:100%; margin:0; font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  background: radial-gradient(1200px 600px at 10% 10%, rgba(56,189,248,0.03), transparent),
              radial-gradient(900px 500px at 90% 85%, rgba(56,189,248,0.02), transparent),
              linear-gradient(180deg,var(--bg-1),var(--bg-2));
  color:#dfffe6;
}
.stage{
  position:relative;
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:36px;
  overflow-y:auto;
}
.glass-card{
  width:var(--card-w); max-width:92vw;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:18px; padding:20px;
  box-shadow:0 10px 40px rgba(0,0,0,0.7),0 0 40px rgba(56,189,248,0.05) inset;
  backdrop-filter: blur(12px) saturate(140%);
  border:1px solid var(--glass-border);
  text-align:center;
  position:relative;
}
.card-header h1{
  font-family:"JetBrains Mono", monospace;
  font-size:20px;margin:0;color:var(--neon);
  text-transform:uppercase;
  text-shadow:0 0 18px rgba(56,189,248,0.22);
}
.card-header .small-url{font-size:12px;color:var(--muted);margin-top:4px;}
.input-link{
  width:100%; padding:8px; border-radius:8px; border:1px solid var(--glass-border);
  background:rgba(255,255,255,0.02); color:#dfffe6; font-family:"JetBrains Mono", monospace;
  font-size:13px; margin:12px 0; text-align:center;
}
.btn{
  display:flex; align-items:center; justify-content:center;
  background:var(--btn-bg); color:#000; padding:10px 12px;
  border-radius:24px; font-weight:700; text-decoration:none; text-align:center; margin:6px 0; transition:.2s;
  font-family:"JetBrains Mono", monospace;
  gap:8px;
  cursor:pointer;
}
.btn i{font-size:16px;}
.btn:hover:not(.disabled){transform:scale(1.03); box-shadow:0 0 16px rgba(56,189,248,.4);}
.btn.disabled{opacity:0.5; cursor:not-allowed;}
.filleuls{
  margin-top:12px; text-align:left; font-family:"JetBrains Mono", monospace; font-size:13px;
}
.filleuls h3{margin-bottom:6px; font-size:14px; color:var(--neon);}
.filleuls ul{padding-left:20px;}
.filleuls li{margin-bottom:4px;}

/* ===== MENU LATÃ‰RAL ===== */
.side-menu{
  position:fixed; top:0; left:-260px; width:260px; height:100%; background:linear-gradient(180deg,#020617,#0f172a);
  border-right:1px solid var(--glass-border);
  backdrop-filter:blur(12px);
  transition:.3s;
  z-index:1000;
  display:flex; flex-direction:column;
}
.side-menu.active{left:0;}
.menu-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:900; display:none;
}
.menu-overlay.active{display:block;}
.side-header{padding:16px; border-bottom:1px solid var(--glass-border);}
.side-title{font-family:"JetBrains Mono", monospace; font-size:20px; color:var(--neon);}
.side-user{font-size:12px;color:var(--muted);}
.side-links{padding:14px; flex:1;}
.side-links a{display:flex; align-items:center; gap:12px; padding:12px; color:#e5e7eb; text-decoration:none; border-radius:10px; transition:.2s; font-family:"JetBrains Mono", monospace;}
.side-links a:hover{background:rgba(56,189,248,.1); color:var(--neon);}
.side-footer{padding:14px; font-size:12px; text-align:center; color:var(--muted); border-top:1px solid var(--glass-border);}
.hamburger{position:fixed; top:16px; left:16px; font-size:22px; color:var(--neon); cursor:pointer; z-index:1100;}

/* Responsive */
@media (max-width:480px){
  .glass-card{width:90vw;padding:12px;}
  .card-header h1{font-size:16px;}
  .input-link{font-size:12px;}
  .btn{padding:8px 10px;font-size:13px;gap:6px;}
  .filleuls h3{font-size:12px;}
  .filleuls li{font-size:12px;}
  .hamburger{font-size:20px;}
}
</style>
</head>
<body>

<!-- BOUTON MENU -->
<div class="hamburger" onclick="toggleMenu()"><i class="fas fa-bars"></i></div>

<!-- MENU LATÃ‰RAL -->
<div id="sideMenu" class="side-menu">
  <div class="side-header">
    <div class="side-title">ROK XD</div>
    <div class="side-user" id="menuUser">ðŸ‘¤ User</div>
  </div>
  <div class="side-links">
    <a href="/"><i class="fas fa-home"></i> Accueil</a>
    <a href="/pair"><i class="fas fa-link"></i> Pairing</a>
    <a href="/qrpage"><i class="fas fa-qrcode"></i> QR Code</a>
    <a href="/referral"><i class="fas fa-user-plus"></i> Parrainage</a>
    <a href="/logout"><i class="fas fa-power-off"></i> DÃ©connexion</a>
  </div>
  <div class="side-footer">
    Â© 2025 <strong>ROK XD</strong><br>
    <span style="font-size:11px;">BY RAIZEL & KNUT</span>
  </div>
</div>
<div id="menuOverlay" class="menu-overlay" onclick="toggleMenu()"></div>

<main class="stage">
<section class="glass-card">
<header class="card-header">
<h1>Parrainage</h1>
<div class="small-url">Gagnez 5 coins par filleul</div>
</header>

<input type="text" id="refLink" class="input-link" readonly>
<button class="btn" onclick="copyLink()"><i class="fas fa-copy"></i> Copier le lien</button>

<div class="filleuls">
<h3>Vos filleuls :</h3>
<ul id="filleulsList">
  <!-- Les filleuls seront ajoutÃ©s ici -->
</ul>
</div>
</section>
</main>

<script>
const sideMenu = document.getElementById('sideMenu');
const menuOverlay = document.getElementById('menuOverlay');
const menuUser = document.getElementById('menuUser');
const refLinkInput = document.getElementById('refLink');
const filleulsList = document.getElementById('filleulsList');

function toggleMenu(){
  sideMenu.classList.toggle('active');
  menuOverlay.classList.toggle('active');
}

// ðŸ”¹ Messages flottants
function showMessage(msg,color='#38bdf8',duration=3000){
  if(!msg) return;
  const container=document.createElement('div');
  container.style.position='fixed';
  container.style.top='50%';
  container.style.left='50%';
  container.style.transform='translate(-50%,-50%)';
  container.style.background='linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))';
  container.style.backdropFilter='blur(12px) saturate(140%)';
  container.style.border='1px solid rgba(56,189,248,0.22)';
  container.style.padding='20px 28px';
  container.style.borderRadius='18px';
  container.style.color=color==='red'?'#ef4444':'#38bdf8';
  container.style.fontWeight='bold';
  container.style.textAlign='center';
  container.style.fontFamily='"JetBrains Mono", monospace';
  container.style.fontSize='14px';
  container.style.textShadow=color==='red'?'0 0 12px rgba(239,68,68,0.8)':'0 0 12px rgba(56,189,248,0.8)';
  container.style.zIndex=9999;
  container.style.boxShadow='0 10px 30px rgba(0,0,0,0.6), 0 0 20px rgba(56,189,248,0.05) inset';
  container.textContent=msg;
  document.body.appendChild(container);
  setTimeout(()=>container.remove(),duration);
}

// ðŸ”¹ Copier le lien
function copyLink(){
  refLinkInput.select();
  refLinkInput.setSelectionRange(0,99999);
  document.execCommand('copy');
  showMessage("Lien copiÃ© !","#38bdf8");
}

// ðŸ”¹ Charger le lien et les filleuls
async function loadReferral(){
  try{
    const res = await fetch('/coins');
    const data = await res.json();
    menuUser.textContent = 'ðŸ‘¤ '+data.username;
    refLinkInput.value = `${window.location.origin}/register?ref=${encodeURIComponent(data.username)}`;
    filleulsList.innerHTML = '';
    if(data.referrals && data.referrals.length){
      data.referrals.forEach(f => {
        const li = document.createElement('li');
        li.textContent = f + " (+5 coins)";
        filleulsList.appendChild(li);
      });
    } else {
      filleulsList.innerHTML = '<li>Aucun filleul pour le moment.</li>';
    }
  }catch(e){
    console.error(e);
    showMessage("Erreur chargement","#ef4444");
  }
}

loadReferral();
</script>
</body>
</html>
