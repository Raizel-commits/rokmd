<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ROK-XMD • Pairing Code</title>
<style>
:root{
 --primary:#1e3a8a; /* Navy Blue */
 --text:#fff;
 --muted:#b3b3b3;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;margin:0;padding:0;}
body{background:#000;color:var(--text);overflow-x:hidden;}
canvas{position:fixed;inset:0;z-index:-2;}
.overlay{position:fixed;inset:0;z-index:-1;background:radial-gradient(circle at 30% 30%,#1e3a8a30,transparent 40%);pointer-events:none;}
.app{max-width:480px;margin:auto;padding:30px 20px;position:relative;z-index:1;}
.logo{text-align:center;margin-bottom:30px;}
.logo h1{margin:12px 0 4px;letter-spacing:2px;color:var(--text);}
.logo p{color:var(--muted);font-size:14px;margin-bottom:15px;}
.btn{display:block;width:100%;padding:16px;margin-top:12px;border-radius:12px;background:linear-gradient(135deg,var(--primary),#2d4fa0);color:#fff;font-weight:700;border:none;text-align:center;transition:all 0.25s;cursor:pointer;font-size:16px;}
.btn:active{transform:scale(.97);}
.footer-fixed{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:25px;z-index:2;}
.footer-fixed a img{width:40px;height:40px;display:block;}
.footer-text{text-align:center;font-size:12px;color:var(--muted);margin-top:10px;}
a{color:#8bb4ff;text-decoration:none;font-weight:600;}

/* Form elements - WHITE INPUTS */
input{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:2px solid var(--primary);
  background:#ffffff;
  color:#000000;
  margin:8px 0 20px;
  font-size:16px;
}

label{
  font-size:14px;
  color:var(--muted);
  display:block;
  margin-bottom:5px;
}

/* Result display */
.result{
  text-align:center;
  margin-top:20px;
  padding:20px;
  border-radius:12px;
  background:rgba(30, 58, 138, 0.2);
  border:1px solid rgba(30, 58, 138, 0.4);
}

.code{
  font-size:28px;
  letter-spacing:6px;
  color:#8bb4ff;
  font-weight:800;
  margin:10px 0;
  font-family:monospace;
}

/* Loading animation */
.loader {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(30, 58, 138, 0.3);
  border-radius: 50%;
  border-top-color: #1e3a8a;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Instructions at the bottom */
.instructions{
  margin-top:40px;
  padding:20px;
  background:rgba(0,0,0,0.3);
  border-radius:12px;
  border-left:4px solid var(--primary);
}

.instructions h3{
  color:#8bb4ff;
  margin-bottom:15px;
  font-size:1.2em;
}

.instructions-list{
  padding-left:20px;
  margin:0;
}

.instructions-list li{
  margin-bottom:10px;
  padding-left:5px;
}

/* Responsive */
@media (max-width: 480px) {
  .app {
    padding: 20px 15px;
  }
  .btn {
    padding: 14px;
    font-size: 15px;
  }
  input {
    padding: 12px;
  }
  .code {
    font-size: 24px;
    letter-spacing: 4px;
  }
}

/* Status messages */
.status-success {
  color: #4CAF50;
  font-size: 14px;
  margin-top: 10px;
}

.status-error {
  color: #ff4444;
  font-size: 14px;
  margin-top: 10px;
}
</style>
</head>
<body>
<canvas id="bg"></canvas>
<div class="overlay"></div>

<div class="app">
 <div class="logo">
   <h1>ROK-XMD</h1>
   <p>WhatsApp connection via Pairing Code</p>
 </div>

 <!-- Form -->
 <div>
  <label>WhatsApp Number</label>
  <input id="phone" placeholder="2376XXXXXXX" type="tel">
  <label>Bot Name</label>
  <input id="user" placeholder="rokxmd_bot">
  <button class="btn" id="gen">GENERATE CODE</button>
  <div class="result" id="res"></div>
 </div>

 <!-- Instructions at the bottom -->
 <div class="instructions">
   <h3>How to use:</h3>
   <ol class="instructions-list">
     <li>Enter your WhatsApp number (without +)</li>
     <li>Choose a bot name</li>
     <li>Click "Generate Code"</li>
     <li>Open WhatsApp on your phone</li>
     <li>Go to Settings → Linked Devices</li>
     <li>Enter the generated code</li>
     <li>Wait for connection confirmation</li>
   </ol>
 </div>
</div>

<div class="footer-fixed">
 <a href="https://wa.me/237679064679" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp"></a>
 <a href="https://t.me/devraizel" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Telegram"></a>
 <a href="https://github.com/yhrespon/RAIZEXMD" target="_blank"><img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub"></a>
</div>

<div class="footer-text">© 2025 ROK-XMD • Developed by KNUT & DEV-RAIZEL</div>

<script>
// Background animation - FRONTEND DU PAIR.HTML
const canvas = document.getElementById("bg"), ctx = canvas.getContext("2d");
let w,h,particles=[];
function resize(){w=canvas.width=innerWidth;h=canvas.height=innerHeight;}
window.onresize=resize;resize();

// Particles color in navy blue - FRONTEND DU PAIR.HTML
for(let i=0;i<50;i++) particles.push({x:Math.random()*w,y:Math.random()*h,r:2+Math.random()*3,dx:(Math.random()-.5)*0.7,dy:(Math.random()-.5)*0.7});

function animate(){
  ctx.clearRect(0,0,w,h);
  particles.forEach(p=>{
    p.x+=p.dx;
    p.y+=p.dy;
    if(p.x<0||p.x>w)p.dx*=-1;
    if(p.y<0||p.y>h)p.dy*=-1;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle="rgba(30, 58, 138, 0.5)";
    ctx.fill();
  });
  requestAnimationFrame(animate);
}
animate();

window.addEventListener("pointerdown",()=>particles.forEach(p=>{
  p.dx+=Math.random()*2-1;
  p.dy+=Math.random()*2-1;
}));

// Mouse interaction effect for particles - FRONTEND DU PAIR.HTML
window.addEventListener('mousemove', (e) => {
  particles.forEach(p => {
    const dx = e.clientX - p.x;
    const dy = e.clientY - p.y;
    const distance = Math.sqrt(dx * dx + dy * dy);
    
    if (distance < 100) {
      p.dx -= dx * 0.001;
      p.dy -= dy * 0.001;
    }
  });
});

// Additional visual effect for clicks - FRONTEND DU PAIR.HTML
document.querySelectorAll('.btn').forEach(btn => {
  btn.addEventListener('click', function() {
    this.style.transform = 'scale(0.95)';
    setTimeout(() => {
      this.style.transform = '';
    }, 150);
  });
});

// Enter key to trigger generation - FRONTEND DU PAIR.HTML
document.getElementById('phone').addEventListener('keypress', function(e) {
  if(e.key === 'Enter') {
    document.getElementById('gen').click();
  }
});

// Pairing Code generation - BACKEND DU PAIR 2 (SIMPLIFIÉ)
document.getElementById("gen").onclick = async () => {
  const phone = document.getElementById("phone").value.trim();
  const user = document.getElementById("user").value.trim() || "rokxmd_bot";
  const res = document.getElementById("res");
  
  // Validation simple
  if (!phone) {
    res.innerHTML = '<div class="status-error">❌ WhatsApp number is required</div>';
    return;
  }
  
  // Show loading state
  const originalButtonText = document.getElementById("gen").innerHTML;
  document.getElementById("gen").innerHTML = '<span class="loader"></span> GENERATING...';
  document.getElementById("gen").disabled = true;
  
  res.innerHTML = '<div class="status-success"><span class="loader"></span> Connecting to server...</div>';
  
  try {
    // BACKEND INTACT DU PAIR 2 - requête simple
    const r = await fetch(`/code?number=${phone}`);
    const d = await r.json();
    
    if (d.code) {
      // Formatage du code avec tirets (comme dans pair.html)
      const formattedCode = d.code.match(/.{1,2}/g)?.join('-') || d.code;
      
      res.innerHTML = `
        <h3>Pairing Code Generated</h3>
        <div class="code">${formattedCode}</div>
        <p style="font-size:14px;margin-top:10px;">
          Bot: <strong>${user}</strong><br>
          Number: <strong>${phone}</strong><br>
          Status: <span style="color:#4CAF50">✓ Ready to pair</span>
        </p>
        <div class="status-success">
          ✅ Code generated successfully!<br>
          <small>This code will expire in 60 seconds</small>
        </div>
      `;
      
      // Auto-copy to clipboard (optionnel)
      try {
        await navigator.clipboard.writeText(d.code);
        const successMsg = document.createElement('div');
        successMsg.className = 'status-success';
        successMsg.innerHTML = '✓ Code copied to clipboard!';
        res.appendChild(successMsg);
        
        setTimeout(() => {
          if (successMsg.parentNode === res) {
            res.removeChild(successMsg);
          }
        }, 3000);
      } catch (clipboardErr) {
        // Silently fail if clipboard not available
      }
      
    } else {
      res.innerHTML = "❌ Erreur";
    }
  } catch {
    res.innerHTML = '<div class="status-error">❌ Serveur injoignable</div>';
  } finally {
    // Restore button state
    document.getElementById("gen").innerHTML = originalButtonText;
    document.getElementById("gen").disabled = false;
  }
};

// Input validation - FRONTEND DU PAIR.HTML
document.getElementById('phone').addEventListener('input', function() {
  const phone = this.value.trim();
  const isValid = /^[0-9]*$/.test(phone);
  
  if (phone && !isValid) {
    this.style.borderColor = '#ff4444';
    this.style.boxShadow = '0 0 0 2px rgba(255, 68, 68, 0.2)';
  } else {
    this.style.borderColor = phone.length >= 10 ? '#4CAF50' : 'var(--primary)';
    this.style.boxShadow = 'none';
  }
});

// Auto-focus on phone input when page loads - FRONTEND DU PAIR.HTML
window.addEventListener('load', () => {
  document.getElementById('phone').focus();
});
</script>
</body>
</html>
